
# ESP-NOW
The following two topologies uses ESP-NOW communication protocol to relate sensor data to the edge gateway.

## Many-To-One
![Alt text](many-to-one.jpg?raw=true "Many To One") 

## One-To-One
![Alt text](one-to-one.jpg?raw=true "One To One") 

## To setup
- Flash esp-now-websocket firmware onto the esp gateway
  - Join esp32ap wifi to configuire it to join your local wifi network with a static ip
- Flash esp-now-twoway firmware onto the esp worker

## Configure esp gateway
- Configure gateway in your browser with the following url
  - http://{esp-now-gateway-ip}/configure_gateway?wsserver={express-server-ip}&wsport={websocket-port}&sender_addr={esp-now-gateway-mac-address}&pin=32
    - esp-now-gateway-ip:  the static ip address that was assigned to esp-now gateway
    - express-server-ip:  the ip address to the express webserver running on edge device
    - websocket-port:  the web socket port express server is listening on
    - esp-now-gateway-mac-address:  the mac address of esp-now gateway ex: (78:21:84:8C:89:FC)

# Many-To-One Topology
## Register esp worker
- http://{esp-now-gateway-ip}/register?host_addr={worker-mac-address}&recv_addr={esp-now-gateway-mac-address}&device_id={id}&device_name={zone-name}
  - esp-now-gateway-ip:  the static ip address that was assigned to esp-now gateway
  - worker-mac-address:  the mac address of this worker
  - esp-now-gateway-mac-address: the mac address of the esp-now gateway
  - id: assign an id for this work start with 1 for the first worker, 2 for the next & etc.
  - name: give it a name

#   





